"use strict";function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),host="https://newsapi.org/",apiVersion="v1/",Sources="sources/",ArticlesUrl="/articles?source=",URLS=function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"HOST",get:function(){return host}},{key:"API_VERSION",get:function(){return apiVersion}},{key:"SOURCES",get:function(){return Sources}},{key:"ARTICLES",get:function(){return ArticlesUrl}}]),a}(),Article=function a(b,c,d,e,f,g){_classCallCheck(this,a),this.author=e,this.title=b,this.description=d,this.url=c,this.urlToImage=f,this.publishedAt=g},Articles=function(){function a(b,c){_classCallCheck(this,a),this.source=b,this.sortBy=c,this._articles=[]}return _createClass(a,[{key:"Add",value:function(a){this._articles.push(a)}},{key:"Articles",get:function(){return this._articles}}]),a}(),SourceItem=function a(b,c,d,e,f,g,h,i,j){_classCallCheck(this,a),this.id=b,this.name=c,this.description=d,this.url=e,this.category=f,this.language=g,this.country=h,this.urlsToLogos=i,this.sortBysAvailable=j},UrlsToLogos=function a(b,c,d){_classCallCheck(this,a),this.small=b,this.medium=c,this.large=d},SourceService=function(){function a(){_classCallCheck(this,a)}return _createClass(a,[{key:"getSources",value:function(){return fetch(URLS.HOST+URLS.API_VERSION+URLS.SOURCES).then(function(a){return a.ok?a.json():void console.log(a.statusText)}).then(function(a){var b=[],c=!0,d=!1,e=void 0;try{for(var f,g=a.sources[Symbol.iterator]();!(c=(f=g.next()).done);c=!0){var h=f.value;b.push(new SourceItem(h.id,h.name))}}catch(a){d=!0,e=a}finally{try{!c&&g.return&&g.return()}finally{if(d)throw e}}return b}).catch(function(a){console.log(a)})}}]),a}(),ArticleService=function(){function a(){_classCallCheck(this,a)}return _createClass(a,[{key:"getArticlesBySourceId",value:function(a){var b=new Headers;b.append("X-Api-Key","caa2a0adb8424a32bb0a582406293aa1");var c={method:"GET",headers:b,mode:"cors",cache:"default"};return fetch(URLS.HOST+URLS.API_VERSION+URLS.ARTICLES+a,c).then(function(a){return a.ok?a.json():void console.log(a.statusText)}).then(function(a){var b=new Articles(a.source,a.sortBy),c=!0,d=!1,e=void 0;try{for(var f,g=a.articles[Symbol.iterator]();!(c=(f=g.next()).done);c=!0){var h=f.value;b.Add(new Article(h.title,h.url))}}catch(a){d=!0,e=a}finally{try{!c&&g.return&&g.return()}finally{if(d)throw e}}return b}).catch(function(a){console.log(a)})}}]),a}(),SourceController=function(){function a(b,c,d){_classCallCheck(this,a),this._sourceService=c,this._articleService=d,this._sourceView=b,this._sourceView.Controller=this,this._selectedSourceId=null}return _createClass(a,[{key:"loadSources",value:function(){var a=this;return this._sourceService.getSources().then(function(b){b?a.setSources(b):alert("there is no source items")}).catch(function(a){return alert(a)})}},{key:"loadArticles",value:function(a){var b=this;this._articleService.getArticlesBySourceId(a).then(function(a){b.setArticles(a.Articles)}).catch(function(a){return alert(a)})}},{key:"setSources",value:function(a){this._sourceView.showSources(a)}},{key:"setArticles",value:function(a){this._sourceView.showArticles(a)}},{key:"SelectedSourceId",set:function(a){this._selectedSourceId!==a&&(this._selectedSourceId=a,this.loadArticles(this._selectedSourceId))}}]),a}(),sourceItemTemplate=function(a){return"<div>"+a.name+"</div>"},articleItemTemplate=function(a){return'<a href="'+a.url+'">'+a.title+"</a>"},SourcesView=function(){function a(){_classCallCheck(this,a),this.sourcesListControl=document.getElementById("view"),this._controller=null,this.handleEvent=function(a){switch(console.log(this.name),a.type){case"click":this.onSourceSelected(a)}}}return _createClass(a,[{key:"showSources",value:function(a){this.clearView();var b=document.createElement("div"),c=!0,d=!1,e=void 0;try{for(var f,g=a[Symbol.iterator]();!(c=(f=g.next()).done);c=!0){var h=f.value,i=document.createElement("div");i.innerHTML=sourceItemTemplate(h),i.setAttribute("data-source-id",h.id),i.addEventListener("click",this,!1),b.appendChild(i)}}catch(a){d=!0,e=a}finally{try{!c&&g.return&&g.return()}finally{if(d)throw e}}this.sourcesListControl.appendChild(b)}},{key:"onSourceSelected",value:function(a){a.preventDefault();var b=a.currentTarget;null!=this._controller&&(this._controller.SelectedSourceId=b.getAttribute("data-source-id"))}},{key:"showArticles",value:function(a){this.clearView();var b=document.createElement("div"),c=document.createElement("div");c.innerHTML='<a href="'+window.location.href+'">Back</div>',b.appendChild(c);var d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done);d=!0){var i=g.value,j=document.createElement("div");j.innerHTML=articleItemTemplate(i),b.appendChild(j)}}catch(a){e=!0,f=a}finally{try{!d&&h.return&&h.return()}finally{if(e)throw f}}this.sourcesListControl.appendChild(b)}},{key:"clearView",value:function(){this.sourcesListControl.innerHTML=""}},{key:"Controller",set:function(a){this._controller=a}}]),a}();!function(){var a=new SourceController(new SourcesView,new SourceService,new ArticleService);a.loadSources()}();